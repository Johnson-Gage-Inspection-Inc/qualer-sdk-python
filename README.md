# qualer-sdk-python

[![Last Commit](https://img.shields.io/github/last-commit/Johnson-Gage-Inspection-Inc/qualer-sdk-python)](https://github.com/Johnson-Gage-Inspection-Inc/qualer-sdk-python/commits/main)
[![CI](https://github.com/Johnson-Gage-Inspection-Inc/qualer-sdk-python/workflows/CI/badge.svg)](https://github.com/Johnson-Gage-Inspection-Inc/qualer-sdk-python/actions)
[![codecov](https://codecov.io/gh/Johnson-Gage-Inspection-Inc/qualer-sdk-python/branch/main/graph/badge.svg)](https://codecov.io/gh/Johnson-Gage-Inspection-Inc/qualer-sdk-python)
[![Python Versions](https://img.shields.io/badge/python-3.9+-blue)](https://github.com/Johnson-Gage-Inspection-Inc/qualer-sdk-python)
[![Qualer API](https://img.shields.io/badge/Qualer%20API-v1-orange)](https://jgiquality.qualer.com/swagger/ui/index)

This repository contains the Python client for the Qualer API. This package was automatically generated by [Swagger Codegen](https://github.com/swagger-api/swagger-codegen), and it provides client classes and models for interacting with the Qualer API.

## Features

- **Auto-generated Client:** Based on your [spec.json](spec.json) by using the Swagger Codegen CLI.
- **Modern Python Support:** Compatible with Python 3.8+.
- **Extensive API Coverage:** See the [API Documentation](docs/) for details on available endpoints and models.
- **Type Hints:** Full typing support for better IDE integration.
- **Comprehensive Testing:** Automated testing with pytest and coverage reporting.

## Installation

You can install the package using either `pip` or `setuptools`.

### Using pip

```sh
pip install git+https://github.com/Johnson-Gage-Inspection-Inc/qualer-sdk-python.git
```

### Using setuptools

```sh
python setup.py install --user
```

## Usage

After installing, import and use the package in your Python code:

```python
from qualer_sdk import AuthenticatedClient
from qualer_sdk.api.report_datasets import get_service_orders

# Initialize the client with authentication token
# (base_url defaults to https://api.johnson-gage.com)
client = AuthenticatedClient(token="your-api-token-here")

# Call API endpoints directly
service_orders = get_service_orders.sync(client=client, customer_id=12345)
print(service_orders)

# Or use async
import asyncio
async def main():
    service_orders = await get_service_orders.asyncio(client=client, customer_id=12345)
    print(service_orders)

asyncio.run(main())
```

For more details on each API, refer to the generated [API documentation](docs/).

## Authentication

The SDK supports token-authenticated requests using the `AuthenticatedClient` class. The base URL defaults to the correct Qualer API endpoint:

```python
from qualer_sdk import AuthenticatedClient
from qualer_sdk.api.report_datasets import get_as_found_measurements_by_order

# Initialize with token (base_url defaults to https://api.johnson-gage.com)
client = AuthenticatedClient(token="your-api-token-here")

# Call authenticated endpoints
measurements = get_as_found_measurements_by_order.sync(
    client=client, 
    service_order_id=285227
)
print(measurements)
```

You can also override the base URL if needed:

```python
client = AuthenticatedClient(
    base_url="https://custom-api-endpoint.com",
    token="your-api-token-here"
)
```


## Development

### Setting up Development Environment

1. Clone the repository:
```sh
git clone https://github.com/Johnson-Gage-Inspection-Inc/qualer-sdk-python.git
cd qualer-sdk-python
```

2. Install development dependencies:
```sh
pip install -r requirements-dev.txt
pip install -e .
```

3. (Optional) Set up pre-commit hooks:
```sh
pre-commit install
```

### Development Commands

The project includes a Makefile with convenient commands:

```sh
make help           # Show available commands
make install        # Install package in editable mode
make install-dev    # Install development dependencies
make test           # Run tests
make test-cov       # Run tests with coverage
make lint           # Run linting checks
make format         # Format code with black and isort
make type-check     # Run type checking with mypy
make build          # Build package
make clean          # Clean build artifacts
make regenerate     # Regenerate SDK from OpenAPI spec
make check-all      # Run all checks (lint, type-check, test)
make ci             # Run full CI pipeline locally
```

### Running Tests

Run the test suite:
```sh
pytest tests/ -v
```

Run tests with coverage:
```sh
pytest tests/ -v --cov=qualer_sdk --cov-report=html
```

### Code Quality

The project uses several tools for code quality:
- **Black** for code formatting
- **isort** for import sorting
- **flake8** for linting
- **mypy** for type checking
- **pytest** for testing with coverage

## CI/CD

This project uses GitHub Actions for continuous integration:

- **Testing:** Automated testing across Python 3.8-3.12
- **Linting:** Code quality checks with flake8
- **Type Checking:** Static analysis with mypy
- **Coverage:** Test coverage reporting with codecov
- **Building:** Package building and validation
- **Publishing:** Automatic PyPI publishing on tagged releases (optional)

### GitHub Actions Workflows

- **CI Pipeline** (`.github/workflows/ci.yml`): Runs on every push and PR
- **Dependabot** (`.github/dependabot.yml`): Automated dependency updates

## Prerequisites

### Java Requirement

To regenerate the SDK, you must have Java installed on your system. The `regenerate_sdk.py` script uses the Swagger Codegen CLI, which requires Java (version 8 or higher).

- **Download Java:**
  - [Oracle JDK Downloads](https://www.oracle.com/java/technologies/downloads/)
  - [Adoptium OpenJDK](https://adoptium.net/)
- **Verify Installation:**
  - After installing, verify Java is available by running the following command in your terminal:
    ```sh
    java -version
    ```
  - You should see output indicating the installed Java version.
- **Troubleshooting:**
  - If you see an error like `'java' is not recognized as an internal or external command`, ensure Java is added to your system's PATH environment variable. See [How to set JAVA_HOME in Windows](https://www.baeldung.com/java-home-on-windows-7-8-10-mac-os-x-linux) for guidance.

## Regenerating the SDK

If you need to update or regenerate the SDK based on a new specification:

```sh
python regenerate_sdk.py
```

This script uses the [openapi-generator-cli.jar](openapi-generator-cli.jar) along with [spec.json](spec.json). It also employs the [fix_swagger_spec.py](fix_swagger_spec.py) script to resolve issues with multiple content types in the OpenAPI specification, which can cause warnings during SDK generation.

The regeneration process has been refactored to use modular template files located in the `templates/` directory:
- **Exception classes**: Defined in `templates/exceptions.py`
- **Package initialization**: Main template in `templates/init_template.py`  
- **API initialization**: API-specific template in `templates/api_init_template.py`
- **Models initialization**: Models-specific template in `templates/models_init_template.py`

This modular approach improves maintainability and makes it easier to customize the generated SDK structure.

## Running Tests

The repository includes comprehensive tests for various API endpoints and functionality. You can run the tests using `pytest`:

```sh
# Run all tests
pytest tests/ -v

# Run tests with coverage
pytest tests/ -v --cov=qualer_sdk --cov-report=html

# Run the SDK regeneration tests
pytest test_regenerate_sdk.py -v
```

## Repository Structure

```
qualer-sdk-python/
├── .github/                    # GitHub Actions workflows and config
│   ├── workflows/
│   │   └── ci.yml             # CI/CD pipeline
│   └── dependabot.yml         # Dependency update config
├── src/
│   └── qualer_sdk/            # Main package source code
│       ├── __init__.py        # Package initialization
│       ├── api/               # API endpoint classes
│       └── models/            # Data model classes
├── tests/                     # Unit tests
├── docs/                      # Generated API documentation
├── templates/                 # Template files for SDK generation
│   ├── exceptions.py          # Exception classes template
│   ├── init_template.py       # Main __init__.py template
│   ├── api_init_template.py   # API __init__.py template
│   └── models_init_template.py # Models __init__.py template
├── .pre-commit-config.yaml    # Pre-commit hooks configuration
├── Makefile                   # Development commands
├── pyproject.toml             # Modern Python packaging config
├── requirements.txt           # Runtime dependencies
├── requirements-dev.txt       # Development dependencies
├── regenerate_sdk.py          # Script for regenerating the SDK
├── setup.py                   # Legacy packaging script
└── spec.json                  # API specification
```

### Key Changes from Original Structure

The repository has been restructured to follow modern Python packaging standards:
- Moved from nested `src/qualer_sdk/qualer_sdk/` to clean `src/qualer_sdk/`
- Tests moved from `src/qualer_sdk/test/` to standard `tests/` directory
- Documentation moved from `src/qualer_sdk/docs/` to standard `docs/` directory
- Added modern `pyproject.toml` with comprehensive build configuration
- Enhanced CI/CD pipeline with GitHub Actions
- **Refactored SDK generation**: Template files moved from embedded strings to modular files in `templates/` directory for better maintainability

## Contributing

Contributions to improve the SDK or scripts are welcome. Please fork this repository and submit a pull request with your changes.

## License

This project is provided “as-is” without any warranty. See the LICENSE file for more information.
